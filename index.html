<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Keep moving. Don&apos;t settle.">
<meta property="og:type" content="website">
<meta property="og:title" content="Coco">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Coco">
<meta property="og:description" content="Keep moving. Don&apos;t settle.">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coco">
<meta name="twitter:description" content="Keep moving. Don&apos;t settle.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Coco</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coco</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Hello world</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/27/tf05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/27/tf05/" itemprop="url">Tensorflow api整理(5)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-27T16:11:32+08:00">
                2018-03-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="tf-train-exponential-decay-learning-rate-global-step-decay-steps-decay-rate-staircase-False-name-None"><a href="#tf-train-exponential-decay-learning-rate-global-step-decay-steps-decay-rate-staircase-False-name-None" class="headerlink" title="tf.train.exponential_decay(learning_rate, global_step, decay_steps, decay_rate, staircase=False, name=None)"></a>tf.train.exponential_decay(learning_rate, global_step, decay_steps, decay_rate, staircase=False, name=None)</h4><p>Applies exponential decay to the learning rate.<br>When training a model, it is often recommended to <strong><em>lower the learning rate as the training progresses</em></strong>. This function applies an exponential decay function to a provided initial learning rate. It requires <strong><em>a global_step value to compute the decayed learning rate</em></strong>. You can just pass a TensorFlow variable that you increment at each training step.</p>
<p>The function returns the decayed learning rate. It is computed as:</p>
<blockquote>
<p>decayed_learning_rate = learning_rate *<br>                      decay_rate ^ (global_step / decay_steps)</p>
</blockquote>
<p>If the argument staircase is True, then global_step /decay_steps is an integer division and the decayed learning rate follows a staircase function.</p>
<h5 id="Example-decay-every-100000-steps-with-a-base-of-0-96"><a href="#Example-decay-every-100000-steps-with-a-base-of-0-96" class="headerlink" title="Example: decay every 100000 steps with a base of 0.96"></a>Example: decay every 100000 steps with a base of 0.96</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">global_step = tf.Variable(<span class="number">0</span>, trainable=<span class="keyword">False</span>)</span><br><span class="line">starter_learning_rate = <span class="number">0.1</span></span><br><span class="line">learning_rate = tf.exponential_decay(starter_learning_rate, global_step,</span><br><span class="line">                                     <span class="number">100000</span>, <span class="number">0.96</span>, staircase=<span class="keyword">True</span>)</span><br><span class="line">optimizer = tf.GradientDescent(learning_rate)</span><br><span class="line"><span class="comment"># Passing global_step to minimize() will increment it at each step.</span></span><br><span class="line">optimizer.minimize(...my loss..., global_step=global_step)</span><br></pre></td></tr></table></figure>
<p>Args:</p>
<ul>
<li>learning_rate: A scalar float32 or float64 Tensor or a Python number. The initial learning rate.</li>
<li>global_step: A scalar int32 or int64 Tensor or a Python number. Global step to use for the decay computation. Must not be negative.</li>
<li>decay_steps: A scalar int32 or int64 Tensor or a Python number. Must be positive. See the decay computation above.</li>
<li>decay_rate: A scalar float32 or float64 Tensor or a Python number. The decay rate.</li>
<li>staircase: Boolean. It True decay the learning rate at discrete intervals.</li>
<li>name: string. Optional name of the operation. Defaults to ‘ExponentialDecay’</li>
</ul>
<p>Returns:<br>A scalar Tensor of the same type as learning_rate. <strong><em>The decayed learning rate</em></strong>.</p>
<h4 id="class-tf-train-ExponentialMovingAverage"><a href="#class-tf-train-ExponentialMovingAverage" class="headerlink" title="class tf.train.ExponentialMovingAverage"></a>class tf.train.ExponentialMovingAverage</h4><p>Some training algorithms, such as <strong><em>GradientDescent and Momentum often benefit from maintaining a moving average of variables during optimization</em></strong>. Using the moving averages for evaluations often improve results significantly.</p>
<p>Maintains moving averages of variables by employing and exponential decay.</p>
<p>When training a model, it is often beneficial to maintain moving averages of the trained parameters. Evaluations that use averaged parameters sometimes produce significantly better results than the final trained values.</p>
<p>The apply() method adds shadow copies of trained variables and add ops that maintain a moving average of the trained variables in their shadow copies. It is used when building the training model. The ops that maintain moving averages are typically run after each training step. The average() and average_name() methods give access to the shadow variables and their names. They are useful when building an evaluation model, or when restoring a model from a checkpoint file. They help use the moving averages in place of the last trained values for evaluations.</p>
<p>The moving averages are computed using exponential decay. You specify the decay value when creating the ExponentialMovingAverage object. The shadow variables are initialized with the same initial values as the trained variables. When you run the ops to maintain the moving averages, each shadow variable is updated with the formula:</p>
<p>shadow_variable -= (1 - decay) * (shadow_variable - variable)</p>
<p>This is mathematically equivalent to the classic formula below, but the use of an assign_sub op (the “-=” in the formula) allows concurrent lockless updates to the variables:</p>
<p>shadow_variable = decay <em> shadow_variable + (1 - decay) </em> variable</p>
<p>Reasonable values for decay are close to 1.0, typically in the multiple-nines range: 0.999, 0.9999, etc.</p>
<p>Example usage when creating a training model:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create variables.</span></span><br><span class="line">var0 = tf.Variable(...)</span><br><span class="line">var1 = tf.Variable(...)</span><br><span class="line"><span class="comment"># ... use the variables to build a training model...</span></span><br><span class="line">...</span><br><span class="line"><span class="comment"># Create an op that applies the optimizer.  This is what we usually</span></span><br><span class="line"><span class="comment"># would use as a training op.</span></span><br><span class="line">opt_op = opt.minimize(my_loss, [var0, var1])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an ExponentialMovingAverage object</span></span><br><span class="line">ema = tf.train.ExponentialMovingAverage(decay=<span class="number">0.9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the shadow variables, and add ops to maintain moving averages</span></span><br><span class="line"><span class="comment"># of var0 and var1.</span></span><br><span class="line">maintain_averages_op = ema.apply([var0, var1])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an op that will update the moving averages after each training</span></span><br><span class="line"><span class="comment"># step.  This is what we will use in place of the usuall trainig op.</span></span><br><span class="line"><span class="keyword">with</span> tf.control_dependencies([opt_op]):</span><br><span class="line">    training_op = tf.group(maintain_averages_op)</span><br><span class="line"></span><br><span class="line">...train the model by running training_op...</span><br></pre></td></tr></table></figure>
<p>There are two ways to use the moving averages for evaluations:</p>
<p>Build a model that uses the shadow variables instead of the variables. For this, use the average() method which returns the shadow variable for a given variable.<br>Build a model normally but load the checkpoint files to evaluate by using the shadow variable names. For this use the average_name() method. See the Saver class for more information on restoring saved variables.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/22/tf04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/22/tf04/" itemprop="url">Tensorflow api整理(4)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-22T15:16:12+08:00">
                2017-11-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="tf-app-run"><a href="#tf-app-run" class="headerlink" title="tf.app.run()"></a>tf.app.run()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""Generic entry point script."""</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.python.platform <span class="keyword">import</span> flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(main=None)</span>:</span></span><br><span class="line">  f = flags.FLAGS</span><br><span class="line">  f._parse_flags() ---&gt;B</span><br><span class="line">  main = main <span class="keyword">or</span> sys.modules[<span class="string">'__main__'</span>].main</span><br><span class="line">  sys.exit(main(sys.argv))</span><br></pre></td></tr></table></figure>
<p>A:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_parse_flags</span><span class="params">(self)</span>:</span>  </span><br><span class="line">  result, _ = _global_parser.parse_known_args()  </span><br><span class="line">  <span class="keyword">for</span> flag_name, val <span class="keyword">in</span> vars(result).items():  </span><br><span class="line">    self.__dict__[<span class="string">'__flags'</span>][flag_name] = val  </span><br><span class="line">  self.__dict__[<span class="string">'__parsed'</span>] = <span class="keyword">True</span></span><br></pre></td></tr></table></figure></p>
<h4 id="tf-image-random-crop-image-size-seed-None-name-None"><a href="#tf-image-random-crop-image-size-seed-None-name-None" class="headerlink" title="tf.image.random_crop(image, size, seed=None, name=None)"></a>tf.image.random_crop(image, size, seed=None, name=None)</h4><p>Randomly crops image to size [target_height, target_width].<br>随机裁剪[target_height,target_width]大小的图片.</p>
<p>The offset of the output within image is uniformly random. image always fully contains the result.</p>
<p>Args:</p>
<ul>
<li>image: 3-D tensor of shape [height, width, channels]<br>图像源.</li>
<li>size: 1-D tensor with two elements, specifying target [height, width]<br>切割大小.</li>
<li>seed: A Python integer. Used to create a random seed. See set_random_seed for behavior.</li>
<li>name: A name for this operation (optional).</li>
</ul>
<p>Returns:<br>A cropped 3-D tensor of shape [target_height, target_width, channels].</p>
<h4 id="tf-image-random-flip-left-right-image-seed-None"><a href="#tf-image-random-flip-left-right-image-seed-None" class="headerlink" title="tf.image.random_flip_left_right(image, seed=None)"></a>tf.image.random_flip_left_right(image, seed=None)</h4><p>Randomly flip an image horizontally (left to right).<br>随机水平裁剪图片。</p>
<p>With a 1 in 2 chance, outputs the contents of image flipped along the second dimension, which is width. Otherwise output the image as-is.</p>
<p>Args:</p>
<ul>
<li>image: A 3-D tensor of shape [height, width, channels].</li>
<li>seed: A Python integer. Used to create a random seed. See set_random_seed for behavior.</li>
</ul>
<p>Returns:<br>A 3-D tensor of the same type and shape as image.</p>
<h4 id="tf-image-random-brightness-image-max-delta-seed-None"><a href="#tf-image-random-brightness-image-max-delta-seed-None" class="headerlink" title="tf.image.random_brightness(image, max_delta, seed=None)"></a>tf.image.random_brightness(image, max_delta, seed=None)</h4><p>Adjust the brightness of images by a random factor.<br>调节明亮度。</p>
<p>Equivalent to adjust_brightness() using a delta randomly picked in the interval [-max_delta, max_delta).</p>
<p>Note that delta is picked as a float. Because for integer type images, the brightness adjusted result is rounded before casting, integer images may have modifications in the range [-max_delta,max_delta].</p>
<p>Args:</p>
<ul>
<li>image: 3-D tensor of shape [height, width, channels].</li>
<li>max_delta: float, must be non-negative.</li>
<li>seed: A Python integer. Used to create a random seed. See set_random_seed for behavior.</li>
</ul>
<p>Returns:<br>3-D tensor of images of shape [height, width, channels]</p>
<h4 id="tf-image-random-contrast-image-lower-upper-seed-None"><a href="#tf-image-random-contrast-image-lower-upper-seed-None" class="headerlink" title="tf.image.random_contrast(image, lower, upper, seed=None)"></a>tf.image.random_contrast(image, lower, upper, seed=None)</h4><p>Adjust the contrase of an image by a random factor.<br>调节对比度。</p>
<p>Equivalent to adjust_constrast() but uses a contrast_factor randomly picked in the interval [lower, upper].</p>
<p>Args:</p>
<ul>
<li>image: 3-D tensor of shape [height, width, channels].</li>
<li>lower: float. Lower bound for the random contrast factor.</li>
<li>upper: float. Upper bound for the random contrast factor.</li>
<li>seed: A Python integer. Used to create a random seed. See set_random_seed for behavior.</li>
</ul>
<p>Returns:<br>3-D tensor of shape [height, width, channels].</p>
<h4 id="tf-image-per-image-standardization-image"><a href="#tf-image-per-image-standardization-image" class="headerlink" title="tf.image.per_image_standardization(image)"></a>tf.image.per_image_standardization(image)</h4><p>图片的标准化，可以加速神经网络训练。why?<br>包含以下步骤：<br>(x - mean) / adjusted_stddev<br>x 为RGB三通道像素值，mean为RGB三通道像素均值，其中<br>adjusted_stddev = max(stddev, 1.0/sqrt(image.NumElements()))<br>stddev为RGB三通道像素的标准差,image.NumElements为RGB三通道像素的个数</p>
<h4 id="tf-cast-x-dtype-name-None"><a href="#tf-cast-x-dtype-name-None" class="headerlink" title="tf.cast(x, dtype, name=None)"></a>tf.cast(x, dtype, name=None)</h4><p>Casts a tensor to a new type.<br>将x类型转换为dtype类型。</p>
<p>The operation casts x (in case of Tensor) or x.values (in case of SparseTensor) to dtype.</p>
<p>For example:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># tensor `a` is [1.8, 2.2], dtype=tf.float</span><br><span class="line">tf.cast(a, tf.int32) ==&gt; [1, 2]  # dtype=tf.int32</span><br></pre></td></tr></table></figure></p>
<p>Args:</p>
<ul>
<li>x: A Tensor or SparseTensor.</li>
<li>dtype: The destination type.</li>
<li>name: A name for the operation (optional).<br>Returns:</li>
</ul>
<p>A Tensor or SparseTensor with same shape as x.</p>
<h4 id="tf-FixedLengthRecordReader-read-queue-name-None"><a href="#tf-FixedLengthRecordReader-read-queue-name-None" class="headerlink" title="tf.FixedLengthRecordReader.read(queue, name=None)"></a>tf.FixedLengthRecordReader.read(queue, name=None)</h4><p>Returns the next record (key, value pair) produced by a reader.</p>
<p>Will dequeue a work unit from queue if necessary (e.g. when the Reader needs to start reading from a new file since it has finished with the previous file).<br>从队列中读取一个unit，以键值对的形式返回。<br>Args:</p>
<ul>
<li>queue: A Queue or a mutable string Tensor representing a handle to a Queue, with string work items.</li>
<li>name: A name for the operation (optional).</li>
</ul>
<p>Returns:<br>A tuple of Tensors (key, value).</p>
<ul>
<li>key: A string scalar Tensor.</li>
<li>value: A string scalar Tensor.</li>
</ul>
<h4 id="tf-decode-raw-bytes-out-type-little-endian-None-name-None"><a href="#tf-decode-raw-bytes-out-type-little-endian-None-name-None" class="headerlink" title="tf.decode_raw(bytes, out_type, little_endian=None, name=None)"></a>tf.decode_raw(bytes, out_type, little_endian=None, name=None)</h4><p>Reinterpret the bytes of a string as a vector of numbers.<br>将string重新转换为向量。</p>
<p>Args:</p>
<ul>
<li>bytes: A Tensor of type string. All the elements must have the same length.</li>
<li>out_type: A tf.DType from: tf.float32, tf.float64, tf.int32, tf.uint8, tf.int16, tf.int8, tf.int64.</li>
<li>little_endian: An optional bool. Defaults to True. Whether the input bytes are in little-endian order. Ignored for out_types that are stored in a single byte like uint8.</li>
<li>name: A name for the operation (optional).</li>
</ul>
<p>Returns:<br>A Tensor of type out_type. A Tensor with one more dimension than the input bytes. The added dimension will have size equal to the length of the elements of bytes divided by the number of bytes to represent out_type.<br>返回比输入大一维的out_type类型的tensor</p>
<h4 id="tf-slice-input-begin-size-name-None"><a href="#tf-slice-input-begin-size-name-None" class="headerlink" title="tf.slice(input_, begin, size, name=None)"></a>tf.slice(input_, begin, size, name=None)</h4><p>Extracts a slice from a tensor.</p>
<p>This operation extracts a slice of size size from a tensor input starting at the location specified by begin. The slice size is represented as a tensor shape, where size[i] is the number of elements of the ‘i’th dimension of input that you want to slice. </p>
<p>在输入的tensor中从位置begin[i]起提出长度为size[i]的片段，size使用tesnsor shape表示，size[i]代表输入的第i维的元素个数.<br>这个函数稍微有点抽象，可以首先从二维开始想：<br>input is :<br>[[1,2,3], [4,5,6], [7,8,9]]<br>如果begin = [1,1]<br>size = [2,2]<br>那么就从[1,1]位置开始，即5的位置开始，截取2行2列的片段，也就是：<br>[[5,6],[8,9]]</p>
<p>同理在三维情况下，看看这个官方例子：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 'input' is [[[1, 1, 1], [2, 2, 2]],</span></span><br><span class="line"><span class="comment">#             [[3, 3, 3], [4, 4, 4]],</span></span><br><span class="line"><span class="comment">#             [[5, 5, 5], [6, 6, 6]]]</span></span><br><span class="line">tf.slice(input, [1, 0, 0], [1, 1, 3]) ==&gt; [[[3, 3, 3]]]</span><br><span class="line">tf.slice(input, [1, 0, 0], [1, 2, 3]) ==&gt; [[[3, 3, 3],</span><br><span class="line">                                            [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>]]]</span><br><span class="line">tf.slice(input, [1, 0, 0], [2, 1, 3]) ==&gt; [[[3, 3, 3]],</span><br><span class="line">                                           [[<span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>]]]</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>Ex.1 :<br>  以[1,0,0]为起点，划分[1,1,3]的大小，1即[[3, 3, 3], [4, 4, 4]]这个数组A的位置，大小为1,那么就是这个数组A本身；0即[3,3,3]这个数组B的位置,大小为1,那么就是这个数组B的位置，0即第一个3这个位置,大小为3,那么就包含从这个3开始的3个数即3,3,3;所以结果为[[[3,3,3]]]</p>
</li>
<li><p>Ex.2 ：<br>  以[1,0,0]为起点，划分[1,2,3]的大小，1即[[3, 3, 3], [4, 4, 4]]这个数组A的位置，大小为1,那么就是这个数组A本身；0即[3,3,3]这个数组B的位置,大小为2,那么就是[3,3,3],[4,4,4]两个数组，0即第一个3和第一个4这个位置,大小为3,那么就包含从这个3(4)开始的3个数即3,3,3(4,4,4);所以结果为[[[3,3,3],[4,4,4]]]</p>
<p>  同理Ex.3.</p>
<p>  ​</p>
<h4 id="tf-merge-all-summaries-key-’summaries’"><a href="#tf-merge-all-summaries-key-’summaries’" class="headerlink" title="tf.merge_all_summaries(key=’summaries’)"></a>tf.merge_all_summaries(key=’summaries’)</h4><p>(tf.summary.merge_all())</p>
</li>
</ul>
<p>Merges all summaries collected in the default graph.<br>收集graph中所有的summaries.</p>
<p>Args:<br>key: GraphKey used to collect the summaries. Defaults to GraphKeys.SUMMARIES.</p>
<p>Returns:<br>If no summaries were collected, returns None. Otherwise returns a scalar Tensor of typestring containing the serialized Summary protocol buffer resulting from the merging.</p>
<h4 id="tf-get-default-graph"><a href="#tf-get-default-graph" class="headerlink" title="tf.get_default_graph()"></a>tf.get_default_graph()</h4><p>获取默认的图。</p>
<h4 id="tf-Graph-as-graph-def"><a href="#tf-Graph-as-graph-def" class="headerlink" title="tf.Graph.as_graph_def"></a>tf.Graph.as_graph_def</h4><p>(from_version=None, add_shapes=False)<br>返回图的序列化表示。</p>
<h4 id="tf-summary-FileWriter-FLAGS-eval-dir-graph-def-graph-def"><a href="#tf-summary-FileWriter-FLAGS-eval-dir-graph-def-graph-def" class="headerlink" title="tf.summary.FileWriter(FLAGS.eval_dir,graph_def=graph_def)"></a>tf.summary.FileWriter(FLAGS.eval_dir,graph_def=graph_def)</h4><p>将运行图得到的summary写到磁盘中。</p>
<h4 id="checkpoint-state"><a href="#checkpoint-state" class="headerlink" title="checkpoint_state"></a>checkpoint_state</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">with tf.Session() as sess:</span><br><span class="line">    ckpt = tf.train.get_checkpoint_state(FLAGS.checkpoint_dir)</span><br><span class="line">    if ckpt and ckpt.model_checkpoint_path:</span><br><span class="line">      # Restores from checkpoint</span><br><span class="line">      saver.restore(sess, ckpt.model_checkpoint_path)</span><br><span class="line">      # Assuming model_checkpoint_path looks something like:</span><br><span class="line">      #   /my-favorite-path/cifar10_train/model.ckpt-0,</span><br><span class="line">      # extract global_step from it.</span><br><span class="line">      global_step = ckpt.model_checkpoint_path.split(&apos;/&apos;)[-1].split(&apos;-&apos;)[-1]</span><br><span class="line">    else:</span><br><span class="line">      print(&apos;No checkpoint file found&apos;)</span><br><span class="line">      return</span><br></pre></td></tr></table></figure>
<h4 id="tf-get-collection-key-scope-None"><a href="#tf-get-collection-key-scope-None" class="headerlink" title="tf.get_collection(key, scope=None)"></a>tf.get_collection(key, scope=None)</h4><p>Wrapper for Graph.get_collection() using the default graph.<br>从图中取出对应Key的所有list values<br>See Graph.get_collection() for more details.</p>
<p>Args:</p>
<ul>
<li>key: The key for the collection. For example, the GraphKeys class contains many standard names for collections.</li>
<li>scope: (Optional.) If supplied, the resulting list is filtered to include only items whose name begins with this string.</li>
</ul>
<p>Returns:<br>The list of values in the collection with the given name, or an empty list if no value has been added to that collection. The list contains the values in the order under which they were collected.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/19/tf03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/19/tf03/" itemprop="url">Tensorflow api整理(3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-19T15:21:34+08:00">
                2017-11-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> tf.Graph().as_default()：<br>访问默认建好的图。tensorflow中一个运算表示为一个图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Copyright 2015 Google Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Licensed under the Apache License, Version 2.0 (the "License");</span></span><br><span class="line"><span class="comment"># you may not use this file except in compliance with the License.</span></span><br><span class="line"><span class="comment"># You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"># distributed under the License is distributed on an "AS IS" BASIS,</span></span><br><span class="line"><span class="comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"># See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"># limitations under the License.</span></span><br><span class="line"><span class="comment"># ==============================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""A binary to train CIFAR-10 using a single GPU.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Accuracy:</span></span><br><span class="line"><span class="string">cifar10_train.py achieves ~86% accuracy after 100K steps (256 epochs of</span></span><br><span class="line"><span class="string">data) as judged by cifar10_eval.py.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Speed: With batch_size 128.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">System        | Step Time (sec/batch)  |     Accuracy</span></span><br><span class="line"><span class="string">------------------------------------------------------------------</span></span><br><span class="line"><span class="string">1 Tesla K20m  | 0.35-0.60              | ~86% at 60K steps  (5 hours)</span></span><br><span class="line"><span class="string">1 Tesla K40m  | 0.25-0.35              | ~86% at 100K steps (4 hours)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">Please see the tutorial and website for how to download the CIFAR-10</span></span><br><span class="line"><span class="string">data set, compile the program and train the model.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">http://tensorflow.org/tutorials/deep_cnn/</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow.python.platform</span><br><span class="line"><span class="keyword">from</span> tensorflow.python.platform <span class="keyword">import</span> gfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> six.moves <span class="keyword">import</span> xrange  <span class="comment"># pylint: disable=redefined-builtin</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cifar10</span><br><span class="line"></span><br><span class="line">FLAGS = tf.app.flags.FLAGS</span><br><span class="line"></span><br><span class="line">tf.app.flags.DEFINE_string(<span class="string">'train_dir'</span>, <span class="string">'/tmp/cifar10_train'</span>,</span><br><span class="line">                           <span class="string">"""Directory where to write event logs """</span></span><br><span class="line">                           <span class="string">"""and checkpoint."""</span>)</span><br><span class="line">tf.app.flags.DEFINE_integer(<span class="string">'max_steps'</span>, <span class="number">30000</span>,</span><br><span class="line">                            <span class="string">"""Number of batches to run."""</span>)</span><br><span class="line">tf.app.flags.DEFINE_boolean(<span class="string">'log_device_placement'</span>, <span class="keyword">False</span>,</span><br><span class="line">                            <span class="string">"""Whether to log device placement."""</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="string">"""Train CIFAR-10 for a number of steps."""</span></span><br><span class="line">  <span class="keyword">with</span> tf.Graph().as_default():</span><br><span class="line">    global_step = tf.Variable(<span class="number">0</span>, trainable=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Get images and labels for CIFAR-10.</span></span><br><span class="line">    <span class="comment"># distorted_inputs()构造了各种随意变换的输入</span></span><br><span class="line">    images, labels = cifar10.distorted_inputs()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build a Graph that computes the logits predictions from the</span></span><br><span class="line">    <span class="comment"># inference model.</span></span><br><span class="line">    logits = cifar10.inference(images)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate loss.</span></span><br><span class="line">    loss = cifar10.loss(logits=logits, labels=labels)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build a Graph that trains the model with one batch of examples and</span></span><br><span class="line">    <span class="comment"># updates the model parameters.</span></span><br><span class="line">    train_op = cifar10.train(loss, global_step)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create a saver.</span></span><br><span class="line">    saver = tf.train.Saver(tf.all_variables())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build the summary operation based on the TF collection of Summaries.</span></span><br><span class="line">    summary_op = tf.summary.merge_all()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build an initialization operation to run below.</span></span><br><span class="line">    init = tf.initialize_all_variables()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Start running operations on the Graph.</span></span><br><span class="line">    sess = tf.Session(config=tf.ConfigProto(</span><br><span class="line">        log_device_placement=FLAGS.log_device_placement))</span><br><span class="line">    sess.run(init)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Start the queue runners.</span></span><br><span class="line">    tf.train.start_queue_runners(sess=sess)</span><br><span class="line"></span><br><span class="line">    summary_writer = tf.summary.FileWriter(FLAGS.train_dir,</span><br><span class="line">                                            graph_def=sess.graph_def)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> step <span class="keyword">in</span> xrange(FLAGS.max_steps):</span><br><span class="line">      start_time = time.time()</span><br><span class="line">      _, loss_value = sess.run([train_op, loss])</span><br><span class="line">      duration = time.time() - start_time</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> <span class="keyword">not</span> np.isnan(loss_value), <span class="string">'Model diverged with loss = NaN'</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> step % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        num_examples_per_step = FLAGS.batch_size</span><br><span class="line">        examples_per_sec = num_examples_per_step / duration</span><br><span class="line">        sec_per_batch = float(duration)</span><br><span class="line"></span><br><span class="line">        format_str = (<span class="string">'%s: step %d, loss = %.2f (%.1f examples/sec; %.3f '</span></span><br><span class="line">                      <span class="string">'sec/batch)'</span>)</span><br><span class="line">        <span class="keyword">print</span> (format_str % (datetime.now(), step, loss_value,</span><br><span class="line">                             examples_per_sec, sec_per_batch))</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> step % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        summary_str = sess.run(summary_op)</span><br><span class="line">        summary_writer.add_summary(summary_str, step)</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Save the model checkpoint periodically.</span></span><br><span class="line">      <span class="keyword">if</span> step % <span class="number">1000</span> == <span class="number">0</span> <span class="keyword">or</span> (step + <span class="number">1</span>) == FLAGS.max_steps:</span><br><span class="line">        checkpoint_path = os.path.join(FLAGS.train_dir, <span class="string">'model.ckpt'</span>)</span><br><span class="line">        saver.save(sess, checkpoint_path, global_step=step)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(argv=None)</span>:</span>  <span class="comment"># pylint: disable=unused-argument</span></span><br><span class="line">  cifar10.maybe_download_and_extract()</span><br><span class="line">  <span class="keyword">if</span> gfile.Exists(FLAGS.train_dir):</span><br><span class="line">    gfile.DeleteRecursively(FLAGS.train_dir)</span><br><span class="line">  gfile.MakeDirs(FLAGS.train_dir)</span><br><span class="line">  train()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">  tf.app.run()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/08/tf02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/08/tf02/" itemprop="url">Tensorflow api整理(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-08T21:31:14+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>API文档：<br><a href="http://wiki.jikexueyuan.com/project/tensorflow-zh/api_docs/python/index.html" target="_blank" rel="noopener">http://wiki.jikexueyuan.com/project/tensorflow-zh/api_docs/python/index.html</a></p>
<h6 id="tf-nn-conv2d-input-filter-strides-padding-use-cudnn-on-gpu-None-name-None"><a href="#tf-nn-conv2d-input-filter-strides-padding-use-cudnn-on-gpu-None-name-None" class="headerlink" title="tf.nn.conv2d(input, filter, strides, padding, use_cudnn_on_gpu=None, name=None)"></a>tf.nn.conv2d(input, filter, strides, padding, use_cudnn_on_gpu=None, name=None)</h6><p>Computes a 2-D convolution given 4-D input and filter tensors.</p>
<ul>
<li>input: A Tensor. Must be one of the following types: float32, float64.</li>
<li>filter: A Tensor. Must have the same type as input.<br>input和filter的通道数需要一致。<br>strides: A list of ints. 1-D of length 4. The stride of the sliding window for each dimension of input.<br>滑动窗口的步长，一维向量，strides[0]=strides[3]=1</li>
<li>padding: A string from: “SAME”, “VALID”. The type of padding algorithm to use.<br>SAME:进行0的补位，左奇右偶。<br>VALID:不进行0的补位，丢弃多余的。</li>
<li>use_cudnn_on_gpu: An optional bool. Defaults to True.<br>name: A name for the operation (optional).</li>
</ul>
<h6 id="tf-truncated-normal-shape-mean-0-0-stddev-1-0-dtype-tf-float32-seed-None-name-None"><a href="#tf-truncated-normal-shape-mean-0-0-stddev-1-0-dtype-tf-float32-seed-None-name-None" class="headerlink" title="tf.truncated_normal(shape, mean=0.0, stddev=1.0, dtype=tf.float32, seed=None, name=None)"></a>tf.truncated_normal(shape, mean=0.0, stddev=1.0, dtype=tf.float32, seed=None, name=None)</h6><p>Outputs random values from a truncated normal distribution.</p>
<p>Args:</p>
<ul>
<li>shape: A 1-D integer Tensor or Python array. The shape of the output tensor.</li>
<li>mean: A 0-D Tensor or Python value of type dtype. The mean of the truncated normal distribution.</li>
<li>stddev: A 0-D Tensor or Python value of type dtype. The standard deviation of the truncated normal distribution.</li>
<li>dtype: The type of the output.</li>
<li>seed: A Python integer. Used to create a random seed for the distribution. See set_random_seed for behavior.</li>
<li>name: A name for the operation (optional).<br>Returns:</li>
</ul>
<p>A tensor of the specified shape filled with random truncated normal values.</p>
<h6 id="tf-constant-value-dtype-None-shape-None-name-’Const’"><a href="#tf-constant-value-dtype-None-shape-None-name-’Const’" class="headerlink" title="tf.constant(value, dtype=None, shape=None, name=’Const’)"></a>tf.constant(value, dtype=None, shape=None, name=’Const’)</h6><p>value: A constant value (or list) of output type dtype.</p>
<p>dtype: The type of the elements of the resulting tensor.</p>
<p>shape: Optional dimensions of resulting tensor.</p>
<p>name: Optional name for the tensor.<br>Returns:</p>
<p>A Constant Tensor.</p>
<h6 id="tf-nn-max-pool-value-ksize-strides-padding-name-None"><a href="#tf-nn-max-pool-value-ksize-strides-padding-name-None" class="headerlink" title="tf.nn.max_pool(value, ksize, strides, padding, name=None)"></a>tf.nn.max_pool(value, ksize, strides, padding, name=None)</h6><p>Performs the max pooling on the input.<br>找出卷积得到的特征图区域的最大值。缩小了特征图。<br>Args:</p>
<ul>
<li>value: <strong><em>A 4-D Tensor with shape [batch, height, width, channels]</em></strong> and type float32, float64, qint8, quint8, qint32.</li>
<li>ksize: A list of ints that has length &gt;= 4. The size of the window for each dimension of the input tensor.<br>ps：一般取[1, height,width,1]，因为不需要在batch和channels上做池化</li>
<li>strides: A list of ints that has length &gt;= 4. The stride of the sliding window for each dimension of the input tensor.</li>
<li>ps:一般取[1, stride,stride, 1]</li>
<li>padding: A string, either ‘VALID’ or ‘SAME’. The padding algorithm.</li>
<li>name: Optional name for the operation.<br>Returns:</li>
</ul>
<p>A Tensor with the same type as value. The max pooled output tensor.</p>
<p>参考：<br><a href="https://www.cnblogs.com/wuzhitj/p/6433871.html" target="_blank" rel="noopener">https://www.cnblogs.com/wuzhitj/p/6433871.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/08/tf01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/08/tf01/" itemprop="url">Tensorflow api整理(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-08T19:23:14+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>API文档：<br><a href="http://wiki.jikexueyuan.com/project/tensorflow-zh/api_docs/python/index.html" target="_blank" rel="noopener">http://wiki.jikexueyuan.com/project/tensorflow-zh/api_docs/python/index.html</a></p>
<h6 id="tf-placeholder-dtype-shape-None-name-None"><a href="#tf-placeholder-dtype-shape-None-name-None" class="headerlink" title="tf.placeholder(dtype, shape=None, name=None)"></a>tf.placeholder(dtype, shape=None, name=None)</h6><ul>
<li>dtype: The type of elements in the tensor to be fed.</li>
<li>shape: The shape of the tensor to be fed (optional). If the shape is not specified, you can feed a tensor of any shape.</li>
<li>name: A name for the operation (optional).</li>
</ul>
<h6 id="tf-Variable-name"><a href="#tf-Variable-name" class="headerlink" title="tf.Variable(, name=)"></a>tf.Variable(<initial-value>, name=<optional-name>)</optional-name></initial-value></h6><ul>
<li>赋予它不同的初值定义不同的张量</li>
</ul>
<h6 id="tf-nn-softmax-logits-name-None"><a href="#tf-nn-softmax-logits-name-None" class="headerlink" title="tf.nn.softmax(logits, name=None)"></a>tf.nn.softmax(logits, name=None)</h6><p>For each batch i and class j we have</p>
<blockquote>
<p>softmax[i, j] = exp(logits[i, j]) / sum(exp(logits[i]))<br>Args:</p>
</blockquote>
<ul>
<li>logits: A Tensor. Must be one of the following types: float32, float64. 2-D with shape [batch_size, num_classes].</li>
<li>name: A name for the operation (optional).</li>
</ul>
<h6 id="tf-matmul-a-b-transpose-a-False-transpose-b-False-a-is-sparse-False-b-is-sparse-False-name-None"><a href="#tf-matmul-a-b-transpose-a-False-transpose-b-False-a-is-sparse-False-b-is-sparse-False-name-None" class="headerlink" title="tf.matmul(a, b, transpose_a=False, transpose_b=False, a_is_sparse=False, b_is_sparse=False, name=None)"></a>tf.matmul(a, b, transpose_a=False, transpose_b=False, a_is_sparse=False, b_is_sparse=False, name=None)</h6><p>Multiplies matrix a by matrix b, producing a * b.</p>
<ul>
<li>a: Tensor of type float, double, int32 or complex64.</li>
<li>b: Tensor with same type as a.</li>
<li>transpose_a: If True, a is transposed before multiplication.</li>
<li>transpose_b: If True, b is transposed before multiplication.</li>
<li>a_is_sparse: If True, a is treated as a sparse matrix.</li>
<li>b_is_sparse: If True, b is treated as a sparse matrix.</li>
<li>name: Name for the operation (optional).</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/车辆检测4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/车辆检测4/" itemprop="url">车辆检测论文（4）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-25T21:05:43+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="An-On-Road-Vehicle-Detection-Method-for-High-Resolution-Aerial-Images-Based-on-Local-and-Global-Structure-Learning"><a href="#An-On-Road-Vehicle-Detection-Method-for-High-Resolution-Aerial-Images-Based-on-Local-and-Global-Structure-Learning" class="headerlink" title="An On-Road Vehicle Detection Method for High-Resolution Aerial Images Based on Local and Global Structure Learning"></a>An On-Road Vehicle Detection Method for High-Resolution Aerial Images Based on Local and Global Structure Learning</h4><p>BY Jiaxing Zhang, Chao Tao, and Zhengrong Zou</p>
<h4 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h4><p>随着图像分辨率的持续提高，航拍图像的细节为车辆检测提供了丰富的可用信息。传统的工作主要是探索车辆整体信息而忽略局部信息，比如前后的挡风玻璃，所以，通常最终会有15%以上的车辆检测结果错误警报，这篇论文主要提供一个充分运用航拍图像的高空细节的车辆检测方法。在训练阶段，他们选择了前挡风玻璃作为样本来训练部分探测器，选择整个车辆作为样本来训练根检测器。在匹配阶段，他们首先使用根检测器来定义获取根响应的整个车辆，然后在根边框盒中扫描整个部分检测器，以此探测前挡风玻璃以及这部分响应。之后，这部分响应在设置基于位置的权重后会被传送出去。更重要的是，上下文信息适用于觉得部分位置偏移量的处理过程中。最终的检测分钟是根响应和传输的部分响应的和。他们论证了这个被提议的方法与state-of-the-art方法相比在正确检测的速率方面获得了多余6.43%的性能增长，在错误检测的速率方面获得了多余5.63%的下降。</p>
<h4 id="文章结构"><a href="#文章结构" class="headerlink" title="文章结构"></a>文章结构</h4><ul>
<li>一 介绍<br>  方法的流程图</li>
<li>二 方法论<br>  A.检测器的构建<pre><code>1）特征提取（HOG）以及检测器学习，用的是SVM
2）两个检测器之间的空间关系
</code></pre>  B.匹配<pre><code>具体步骤
</code></pre></li>
<li>三 实验及分析<br>  A.数据集<br>  B.结果分析</li>
<li>四 与其他方法对比</li>
<li>五 结论</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/车辆检测3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/车辆检测3/" itemprop="url">车辆检测论文（3）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-25T19:25:12+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像/" itemprop="url" rel="index">
                    <span itemprop="name">图像</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2017年</p>
<h4 id="Advance-Automatic-Toll-Collection-amp-Vehicle-Detection-During-Collision-using-RFID"><a href="#Advance-Automatic-Toll-Collection-amp-Vehicle-Detection-During-Collision-using-RFID" class="headerlink" title="Advance Automatic Toll Collection &amp; Vehicle Detection During Collision using RFID"></a>Advance Automatic Toll Collection &amp; Vehicle Detection During Collision using RFID</h4><p>BY Akshay Bhavke  Sadhana Pai</p>
<h4 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h4><p>在这个项目中，我们解决了一个关于收费广场以及车辆识别系统的问题，通过RFID来识别偷窃、事故车辆。车主需要通过手机应用注册账户并且注册RFID tag，当车辆经过收费站时，通过唯一识别码（UIN)，车辆将会被归类于乘客或货物在运输车辆上。货车会在TCU上估重并且如果超载的话，将会增收额外的税。UIN会被发送到CSU来从账户中扣费，一旦在CSU扣费成功，TCS将会打开路障，车辆就可以通过。如果车辆被检测到为失窃车辆，TCS将不会打开路障。同时为了处理肇事逃逸的车辆，车辆中将会使用压电传感器来识别车祸车辆的RFID。</p>
<p>恩…. 和无人驾驶的车辆检测算法似乎没有关系。但是按照这个思路，让所有的汽车都装置RFID tag （但是电磁波发射距离是一个问题），使得所有骑车之间可以互相感应，不就可以完成识别了？但这样的话一个汽车上除了要有电子标签，还要装备阅读器识别器等，似乎有些麻烦。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/Android源码设计模式解析与实战----责任链模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/Android源码设计模式解析与实战----责任链模式/" itemprop="url">Android源码设计模式解析与实战----责任链模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-25T15:31:14+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/Android源码设计模式解析与实战----面向对象的六大原则/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/Android源码设计模式解析与实战----面向对象的六大原则/" itemprop="url">Android源码设计模式解析与实战----面向对象的六大原则</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-25T15:31:14+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/软件工程/" itemprop="url" rel="index">
                    <span itemprop="name">软件工程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="单一职责原则"><a href="#单一职责原则" class="headerlink" title="单一职责原则"></a>单一职责原则</h3><p>一个类只负责一个功能（一个职责），如果一个类增加了职责，应该把这个职责分离出去。<br>如果一个类中承担的职责太多，相当于职责都耦合在了一起，一个职责的变化就可能影响到别的职责。<br>比如：</p>
<ul>
<li>Modem分为链接管理和数据通信两个职责。</li>
<li>俄罗斯方块游戏，界面变化和游戏逻辑（方块下落移动等）分为两个职责。</li>
<li>图片加载器，ImageLoader和ImageCache分离，一个负责加载，一个负责缓存。</li>
</ul>
<h3 id="开闭原则"><a href="#开闭原则" class="headerlink" title="开闭原则"></a>开闭原则</h3><p>对功能扩展是开放的（增加新功能），但对修改原功能代码是关闭的。<br>也就是说，软件变化时，尽量通过扩展来实现变化，而不是通过修改已经有的代码来实现。<br>比如图片加载器中，用接口声明ImageCache，实现多个接口以实现不同的Cache，在ImageLoader中set想要的cache就可以了。</p>
<h3 id="里氏替换原则"><a href="#里氏替换原则" class="headerlink" title="里氏替换原则"></a>里氏替换原则</h3><p>继承时，父类所拥有的性质在子类中仍然要成立，也就是子类的实例能够替换任何父类的实例时，之间才具有is-a关系。<br>在Android中，Window依赖于View，View又是一个抽象实现，继承于View的子类可以重写onDraw(),onMeasure()等方法，通过里式替换，可以定义各种各样的View，交给Window去组织。</p>
<h3 id="依赖倒置原则"><a href="#依赖倒置原则" class="headerlink" title="依赖倒置原则"></a>依赖倒置原则</h3><ul>
<li>高层模块不能依赖于低层模块，二者都应该依赖于抽象。</li>
<li>抽象不依赖于细节，细节依赖于抽象<br>高层模块：调用端。包含重要的业务模型的策略选择，是功能和策略。<br>低层模块：具体实现类。不同业务和策略的实现，是具体实现。<br>模块间的依赖通过抽象发生，实现类之间不发生直接的依赖关系。依赖关系是通过接口或抽象类产生的。<br>一句话就是依赖抽象而不依赖实现。</li>
</ul>
<h3 id="接口隔离原则"><a href="#接口隔离原则" class="headerlink" title="接口隔离原则"></a>接口隔离原则</h3><p>多个和客户相关的接口要好于一个通用接口。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/25/TensorFlow在Android上的构建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ke Yu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coco">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/25/TensorFlow在Android上的构建/" itemprop="url">Tensorflow在Android上的搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-25T15:31:14+08:00">
                2017-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/" itemprop="url" rel="index">
                    <span itemprop="name">AI</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="第一个坑"><a href="#第一个坑" class="headerlink" title="第一个坑"></a>第一个坑</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android_sdk_repository(</span><br><span class="line">    name = &quot;androidsdk&quot;,</span><br><span class="line">    api_level = 24,</span><br><span class="line">#    # Ensure that you have the build_tools_version below installed in the</span><br><span class="line">#    # SDK manager as it updates periodically.</span><br><span class="line">    build_tools_version = &quot;23.0.2&quot;,</span><br><span class="line">#    # Replace with path to Android SDK on your system</span><br><span class="line">    path = &quot;/home/kk/Pictures/SDKK/android-sdk-linux/&quot;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>注意在取消注释时，最后一个括号前面的‘#’也要去掉。</p>
<h3 id="sdk安装"><a href="#sdk安装" class="headerlink" title="sdk安装"></a>sdk安装</h3><p>一直提示WORKSPACE里面的android_sdk_reporitory有错，提示我应该安装sdk，但是我有将sdk安装包解压，build-tools等也进行了解压，并且设置了正确的path，所以一直没考虑到sdk的安装问题，一直以为是不是路径写错了，因为error最后提示到了“Referenced by /‘external/sdk’”类似的字样，所以google(最近被墙的很严重，勉强能用stackoverflow),baidu了很久，把<a href="https://docs.bazel.build/versions/master/tutorial/android-app.html中相关内容看了一遍，还是没找到原因。" target="_blank" rel="noopener">https://docs.bazel.build/versions/master/tutorial/android-app.html中相关内容看了一遍，还是没找到原因。</a><br>后来突然想到会不会真是sdk安装的原因？后来查了一下sdk在Linux上的安装方法，果然有一些问题。<br>解压完sdk包后，进入tools文件夹，用android命令安装sdk,build-tools等工具（其实感觉更像是更新），这样操作后，总算过了这个error。<br>所以实际原因就是sdk的安装不对。</p>
<h3 id="CMakeList-txt"><a href="#CMakeList-txt" class="headerlink" title="CMakeList.txt"></a>CMakeList.txt</h3><pre><code>* 编写了CMake的语句
* 通过CMake语句指向这个.txt所在目录可以生成makefile文件

通过tensorflow_demo的CmakeList.txt文件，分析一下语法：
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">project(TENSORFLOW_DEMO) # 工程名</span><br><span class="line"></span><br><span class="line">#最低版本要求3.4.1，否则不能构建</span><br><span class="line">cmake_minimum_required(VERSION 3.4.1)</span><br><span class="line"></span><br><span class="line">#设置makefile为开启</span><br><span class="line">set(CMAKE_VERBOSE_MAKEFILE on)</span><br><span class="line"></span><br><span class="line"># 得到这个完整文件名的完整路径</span><br><span class="line"># get_filename_component 得到一个完整文件名中的特定部分。</span><br><span class="line"># get_filename_component(&lt;VAR&gt; FileName</span><br><span class="line">                         PATH|ABSOLUTE|NAME|EXT|NAME_WE|REALPATH</span><br><span class="line">                         [CACHE])</span><br><span class="line">#　　将变量#&lt;VAR&gt;设置为路径(PATH)，文件名(NAME)，文件扩展名(EXT)，去掉扩#展名的文件名(NAME_WE)，完整路径(ABSOLUTE)，或者所有符号链接被解析出的完#整路径(REALPATH)。</span><br><span class="line">　　</span><br><span class="line">get_filename_component(TF_SRC_ROOT $&#123;CMAKE_SOURCE_DIR&#125;/../../../..  ABSOLUTE)</span><br><span class="line">get_filename_component(SAMPLE_SRC_DIR  $&#123;CMAKE_SOURCE_DIR&#125;/..  ABSOLUTE)</span><br><span class="line"></span><br><span class="line">if (ANDROID_ABI MATCHES &quot;^armeabi-v7a$&quot;)</span><br><span class="line">    set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -mfloat-abi=softfp -mfpu=neon&quot;)</span><br><span class="line">elseif(ANDROID_ABI MATCHES &quot;^arm64-v8a&quot;)</span><br><span class="line">    set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -O2 -ftree-vectorize&quot;)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">set(CMAKE_CXX_FLAGS &quot;$&#123;CMAKE_CXX_FLAGS&#125; -DSTANDALONE_DEMO_LIB \</span><br><span class="line">                    -std=c++11 -fno-exceptions -fno-rtti -O2 -Wno-narrowing \</span><br><span class="line">                    -fPIE&quot;)</span><br><span class="line">set(CMAKE_SHARED_LINKER_FLAGS &quot;$&#123;CMAKE_SHARED_LINKER_FLAGS&#125; \</span><br><span class="line">                              -Wl,--allow-multiple-definition \</span><br><span class="line">                              -Wl,--whole-archive -fPIE -v&quot;)</span><br><span class="line"></span><br><span class="line">file(GLOB_RECURSE tensorflow_demo_sources $&#123;SAMPLE_SRC_DIR&#125;/jni/*.*)</span><br><span class="line">add_library(tensorflow_demo SHARED</span><br><span class="line">            $&#123;tensorflow_demo_sources&#125;)</span><br><span class="line">target_include_directories(tensorflow_demo PRIVATE</span><br><span class="line">                           $&#123;TF_SRC_ROOT&#125;</span><br><span class="line">                           $&#123;CMAKE_SOURCE_DIR&#125;)</span><br><span class="line"># 执行文件tensorflow_demo依赖的子目录生成的库名字：android,log.....</span><br><span class="line">target_link_libraries(tensorflow_demo</span><br><span class="line">                      android</span><br><span class="line">                      log</span><br><span class="line">                      jnigraphics</span><br><span class="line">                      m</span><br><span class="line">                      atomic</span><br><span class="line">                      z)</span><br></pre></td></tr></table></figure>
<h3 id="Can’t-find-lt-android-log-h-gt"><a href="#Can’t-find-lt-android-log-h-gt" class="headerlink" title="Can’t find &lt;android/log.h&gt;"></a>Can’t find &lt;android/log.h&gt;</h3><p><img src="http://ovwunej09.bkt.clouddn.com/TF01_1.png" alt=""></p>
<ul>
<li>差点忘记了include的用法，本来第一反应android/log.h是路径，然后去上一级android文件夹里看了下….并没有log.h这个文件，又搜索看了下include的用法，发现include应该是搜索系统的一些路径。同时，JNI文件的include查找的是NDK的路径，发现自己还没有设置NDK的环境变量，设置了，问题解决。</li>
</ul>
<h3 id="kernels-svd-op-failed"><a href="#kernels-svd-op-failed" class="headerlink" title="kernels:svd_op,failed"></a>kernels:svd_op,failed</h3><p><img src="http://ovwunej09.bkt.clouddn.com/tf01_5.png" alt=""><br>这个问题有人遇到过，error exit 4的错误，内存空间不足<br><a href="http://blog.csdn.net/cq361106306/article/details/52929468" target="_blank" rel="noopener">http://blog.csdn.net/cq361106306/article/details/52929468</a><br>这里找到两个解决方案</p>
<ul>
<li>命令增加–local_resources 2048,.5,1.0</li>
<li>tensorflow的kernel出现了问题，然后有点怀疑是tensorflow的安装出了问题。<br>于是又找了一个tensorflow源码安装的教程，补充了一些依赖的安装。<blockquote>
<p>sudo apt-get install python-numpy swig python-dev</p>
<p>sudo apt-get install python-numpy python-dev python-pip python-wheel</p>
</blockquote>
</li>
</ul>
<h3 id="‘-aws-aws’-failed"><a href="#‘-aws-aws’-failed" class="headerlink" title="‘@aws//:aws’ failed"></a>‘@aws//:aws’ failed</h3><p>又是一个C++ compilation rule的错误，去到提示的文件README.Bugs中没什么发现，</p>
<p>bazel build -c opt –spawn_strategy=standalone –verbose_failures –local_resources 2048,.5,1.0 //tensorflow/tools/pip_package:build_pip_package</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Ke Yu" />
            
              <p class="site-author-name" itemprop="name">Ke Yu</p>
              <p class="site-description motion-element" itemprop="description">Keep moving. Don't settle.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ke Yu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
